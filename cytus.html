<html>
<head>
<title>cytus</title>
<style>
    .score{
        text-align: right;
    }
    .played{
        text-align: right;
    }
    .TP{
        text-align: right;
        padding-right: 0;
        padding-left: 10px;
    }
    .midtitle{
        text-align: center;
    }
    .ptsM{
        color: red;
    }
    .TPh{
        color: green;
    }
    .ps{
        position: relative;
        right: -100px;
        bottom: 0;
    }
</style>
</head>
<body>
<input type="file" id="file" onchange="getfile(event)"><br>
<input id="ps"><input type="button" id="sub"><br><br>


<select id="which">
<option id="headopt">choose which</option>
</select>
<select id="mod">
<option id="showall">show all</option>
<option id="diff">diff</option>
</select>

<input type="button" id="update">

<div id="showps" class="ps"></div>
<table id="here"></table>

</body>
</html>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

<script src="/static/makeallAppend.js"></script>
<script>
    var socket = io("http://weak2317.infor.org");

    var content;
    function getfile(event){
        var file = event.target.files[0];
        var r = new FileReader();
        r.onload = function(event){
            content = event.target.result;
        }
        r.readAsText(file);
    }

    document.getElementById('sub').onclick = function(){
        var ps = document.getElementById('ps').value;
        console.log(content)
        socket.emit('xml',content,ps);
    }

    socket.emit('give all');
    socket.on('this is all',function(all){
        console.log(all);
        for(var i=0;i<all.length;i++){
            $('#headopt').after("<option value='"+i+"'>"+(all[i]["time"])+"</option>");
        }


        document.getElementById('update').onclick = function(){
            var choosed = document.getElementById('which').value;
            var mod = document.getElementById('mod').value;

            if(mod=="show all"){
                viewthis = all[choosed];
                console.log(viewthis);
                
                var append = makeallAppend(viewthis);

                $('#here').empty();
                $('#here').append(append);

                $('#showps').empty();
                $('#showps').append(viewthis["ps"]);
            }
        }
    })

</script>
